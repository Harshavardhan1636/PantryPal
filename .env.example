# ==============================================
# PANTRYPAL ENVIRONMENT CONFIGURATION
# ==============================================
# Copy this file to .env and fill in your values
# Never commit .env to version control!

# ==============================================
# ENVIRONMENT
# ==============================================
NODE_ENV=development  # development, staging, production
ENVIRONMENT=local     # local, staging, production

# ==============================================
# DATABASE
# ==============================================
# PostgreSQL connection string
DATABASE_URL=postgresql+asyncpg://pantrypal:pantrypal_dev_password@localhost:5432/pantrypal

# For synchronous connections (if needed)
DATABASE_URL_SYNC=postgresql://pantrypal:pantrypal_dev_password@localhost:5432/pantrypal

# Connection pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_RECYCLE=3600
DB_ECHO=false  # Set to true for SQL query logging

# ==============================================
# REDIS
# ==============================================
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0

# Cache TTL (seconds)
CACHE_TTL_SHORT=300    # 5 minutes
CACHE_TTL_MEDIUM=1800  # 30 minutes
CACHE_TTL_LONG=3600    # 1 hour

# ==============================================
# JWT AUTHENTICATION
# ==============================================
# Generate with: openssl rand -hex 32
JWT_SECRET_KEY=your-secret-key-change-in-production-use-openssl-rand
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=10080  # 7 days

# ==============================================
# CORS
# ==============================================
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,http://localhost:9002

# ==============================================
# FRONTEND (Next.js)
# ==============================================
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_AUTH_API=http://localhost:8001
NEXT_PUBLIC_INVENTORY_API=http://localhost:8002
NEXT_PUBLIC_ML_API=http://localhost:8003
NEXT_PUBLIC_RECOMMENDATION_API=http://localhost:8004
NEXT_PUBLIC_NOTIFICATION_API=http://localhost:8005

# ==============================================
# ML SERVICE
# ==============================================
ML_MODEL_PATH=models/waste_risk_v1.pkl
BENTOML_PORT=3000
ML_BATCH_SIZE=32
ML_TIMEOUT_SECONDS=30

# Feature store (Feast)
FEAST_REGISTRY_PATH=s3://pantrypal-ml/feast/registry.db
FEAST_OFFLINE_STORE=postgresql://pantrypal:password@localhost:5432/pantrypal

# ==============================================
# GOOGLE CLOUD (Production)
# ==============================================
GCP_PROJECT_ID=your-project-id
GCP_REGION=us-central1
GCP_BUCKET_RECEIPTS=pantrypal-receipts
GCP_BUCKET_MODELS=pantrypal-ml-models
GCP_BUCKET_PHOTOS=pantrypal-photos

# Service Account Key (JSON)
GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account-key.json

# ==============================================
# EXTERNAL APIs
# ==============================================

# Google Vision API (Receipt OCR)
GOOGLE_VISION_API_KEY=your-google-vision-api-key

# Google Gemini AI (Legacy from MVP)
GOOGLE_GENAI_API_KEY=your-gemini-api-key

# Twilio (SMS Notifications)
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# SendGrid (Email Notifications)
SENDGRID_API_KEY=your-sendgrid-api-key
SENDGRID_FROM_EMAIL=notifications@pantrypal.app
SENDGRID_FROM_NAME=PantryPal

# Firebase Cloud Messaging (Push Notifications)
FCM_SERVER_KEY=your-fcm-server-key

# Open Food Facts
OPENFOODFACTS_API_URL=https://world.openfoodfacts.org/api/v2
OPENFOODFACTS_USER_AGENT=PantryPal/1.0

# Instacart API (if available)
INSTACART_API_KEY=your-instacart-api-key
INSTACART_API_SECRET=your-instacart-api-secret

# Amazon Fresh API (if available)
AMAZON_FRESH_API_KEY=your-amazon-api-key
AMAZON_FRESH_API_SECRET=your-amazon-api-secret

# ==============================================
# RABBITMQ (Background Jobs)
# ==============================================
RABBITMQ_URL=amqp://guest:guest@localhost:5672/
CELERY_BROKER_URL=amqp://guest:guest@localhost:5672/
CELERY_RESULT_BACKEND=redis://localhost:6379/1

# ==============================================
# MONITORING
# ==============================================

# Prometheus
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin

# Sentry (Error Tracking)
SENTRY_DSN=your-sentry-dsn
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# OpenTelemetry
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_SERVICE_NAME=pantrypal

# ==============================================
# LOGGING
# ==============================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json or text

# Elasticsearch (ELK Stack)
ELASTICSEARCH_URL=http://localhost:9200
ELASTICSEARCH_INDEX=pantrypal-logs

# ==============================================
# RATE LIMITING
# ==============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# ==============================================
# FILE UPLOAD
# ==============================================
MAX_UPLOAD_SIZE_MB=10
ALLOWED_IMAGE_TYPES=image/jpeg,image/png,image/webp
ALLOWED_DOCUMENT_TYPES=application/pdf,text/csv

# ==============================================
# SECURITY
# ==============================================
# Bcrypt rounds for password hashing
BCRYPT_ROUNDS=12

# HTTPS enforcement
FORCE_HTTPS=false  # true in production

# Security headers
HSTS_MAX_AGE=31536000
CSP_POLICY="default-src 'self'; img-src 'self' data: https:; script-src 'self' 'unsafe-inline'"

# ==============================================
# WEBHOOKS
# ==============================================
WEBHOOK_TIMEOUT_SECONDS=10
WEBHOOK_MAX_RETRIES=3
WEBHOOK_SECRET_PREFIX=whsec_

# ==============================================
# FEATURE FLAGS
# ==============================================
FEATURE_PHOTO_PANTRY_ENABLED=true
FEATURE_RECIPE_RECOMMENDATIONS_ENABLED=true
FEATURE_RETAILER_INTEGRATIONS_ENABLED=false
FEATURE_PLUGIN_MARKETPLACE_ENABLED=false
FEATURE_TEAM_COLLABORATION_ENABLED=true

# ==============================================
# DEVELOPMENT
# ==============================================
DEBUG=false  # Enable debug mode
HOT_RELOAD=true  # Enable hot reload for development
SQL_ECHO=false  # Log all SQL queries

# ==============================================
# TESTING
# ==============================================
TEST_DATABASE_URL=postgresql+asyncpg://pantrypal:password@localhost:5432/pantrypal_test
TEST_REDIS_URL=redis://localhost:6379/15

# ==============================================
# TERRAFORM (for deployment)
# ==============================================
TF_VAR_project_id=your-gcp-project-id
TF_VAR_region=us-central1
TF_VAR_environment=production
TF_VAR_db_password=generate-secure-password-here

# ==============================================
# KUBERNETES
# ==============================================
K8S_NAMESPACE=pantrypal
K8S_CLUSTER_NAME=pantrypal-gke
K8S_REPLICAS_MIN=3
K8S_REPLICAS_MAX=10

# ==============================================
# CI/CD
# ==============================================
# GitHub Actions secrets (don't add actual values here)
# These should be set in GitHub repository secrets
# - GCP_CREDENTIALS_STAGING
# - GCP_CREDENTIALS_PROD
# - GCP_PROJECT_ID_STAGING
# - GCP_PROJECT_ID_PROD
# - TF_STATE_BUCKET_STAGING
# - TF_STATE_BUCKET_PROD
# - SLACK_WEBHOOK_URL

# ==============================================
# MOBILE APP
# ==============================================
EXPO_PUBLIC_API_URL=http://localhost:8000
EXPO_PUBLIC_WS_URL=ws://localhost:8000

# ==============================================
# ANALYTICS
# ==============================================
# Google Analytics
GA_TRACKING_ID=G-XXXXXXXXXX

# Mixpanel
MIXPANEL_TOKEN=your-mixpanel-token

# ==============================================
# COMPLIANCE
# ==============================================
# GDPR
DATA_RETENTION_DAYS=730  # 2 years
DELETION_REQUEST_DELAY_DAYS=30

# Cookie consent
COOKIE_CONSENT_ENABLED=true

# ==============================================
# PERFORMANCE
# ==============================================
# CDN
CDN_URL=https://cdn.pantrypal.app

# Image optimization
IMAGE_QUALITY=80
IMAGE_MAX_WIDTH=2048
IMAGE_MAX_HEIGHT=2048

# ==============================================
# BACKUP
# ==============================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_BUCKET=pantrypal-backups

# ==============================================
# NOTES
# ==============================================
# 1. Never commit this file with actual secrets
# 2. Use different values for staging and production
# 3. Rotate secrets regularly (every 90 days)
# 4. Use GCP Secret Manager in production
# 5. Set strong passwords (min 16 characters)
# 6. Enable 2FA for all admin accounts
